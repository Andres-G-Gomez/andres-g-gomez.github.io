<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>project 4 | Andres G. Gomez</title> <meta name="author" content="Andres G. Gomez"> <meta name="description" content="Tight Risk Bounds for Distracted Driver Detection"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/initials.JPG?c7eece51f82ad275a2b403a984e67c06"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://andres-g-gomez.github.io/projects/4_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Andres </span>G. Gomez</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/_pages/teaching.html"></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">project 4</h1> <p class="post-description">Tight Risk Bounds for Distracted Driver Detection</p> </header> <article> <p><strong>I. <u>Introduction</u></strong> The leading cause of fatal accidents in the U.S. is due to distracted driving. Although self-driving technologies are becoming commercially prevalent in the U.S., drivers are expected to be fully alert, prepared to take over at any moment. Many newer vehicles are equipped with driver alert systems, which monitor a driver’s behavior either through data collected from external sensors or through a camera system and warn or alert the driver when unsafe behavior is detected. This work will apply and compare various deep learning models to the publicly available State Farm Distracted Driver Detection dataset as well as estimate tighter risk bounds of false positives for distracted drivers than would generally be obtained through confidence intervals. Risk bound characterizations, like binomial proportion confidence intervals, will be determined.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/images_drivers-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/images_drivers-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/images_drivers-1400.webp"></source> <img src="/assets/img/images_drivers.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 1: Sample images from the State Farm Distracted Driver Dataset containing alert drivers (A, B) and distracted drivers (C, D). </div> <p><strong>II. <u>Methods</u></strong></p> <p><strong>A. <u>Data Sampling and Augmentation</u></strong></p> <p>Due to RAM limitations and computational time, a sample of the original dataset set was selected. A sample of about 1130 images was selected for training/validation. This dataset was then split into a training and validation set by partitioning the data with an 80/20 split. To evaluate the accuracy of the estimated BPCI for the precision, 5 different tests sets, each containing approximately 225 images, were sampled from the original dataset. These test sets will be labeled A-E in later sections. All images were sampled from the original dataset without replacement. To save additional memory and computational time, each RGB image was down sampled to a 150x150 image size. To account for noise in the data and enhance in generalizability, data augmentation was applied. The main transformation that was added were random rotations within a 0-to-45-degree range. This angle was decided upon after looking through the dataset and seeing that images were captured at varying angles.</p> <p><strong>B. <u>Convolution Neural Network Frameworks</u></strong></p> <p>Two architectures, shown layer-by-layer in Table 1, were trained, and tested. The first network that was evaluated was one similar to the SCNNB, developed by Lei, Dai, and Ling (2020) [8]. The simplicity of the frameworks allows for faster training. The size of the input data is 150x150x3. As described in [8], SCNNB first extracts data features by a 3x3 convolution with 32 filters. Next, a 2x2 max-pooling layer is applied to reduce the dimensionality as well as the training time.</p> <p>Afterwards, two sequential 3x3 convolution layers with 64 filters are applied to extract additional features. The output is fed to a 2x2 max-pooling layer. Then, a fully connected layer of 1280 neurons is applied, followed by another fully connected layer with 512 neurons. In the original SCNNB, the last layer is a softmax output layer and is used to achieve multi-classification. Since this problem is a binary classification problem, the last layer was changed to a single neuron with a sigmoid activation function.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/table1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/table1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/table1-1400.webp"></source> <img src="/assets/img/table1.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Table 1: Architectures of the two CNNs that were trained and evaluated. Framework 1 corresponds to the CNN trained from scratch. Framework 2 utilizes transfer learning techniques. </div> <p><strong>C. <u>Transfer Learning with Xception</u></strong></p> <p>Framework 2 had the Xception model as the base model. The Xception model, developed by Francois Chollet in 2016, is a leading image classification CNN. In a competition involving over 350 million photos with 17,000 classes, it dramatically outperformed the previous competition leader. The main difference between the Xception model and other leading CNN architectures is it assumes cross-channel and spatial patterns can be analyzed separately. So, the architecture first separates the channels, identifies spatial features from each channel, then applies depth-wise 1x1 convolution to look for cross-channel patterns amongst the extracted features [9]. These depthwise convolutions cannot caprute spatial patterns, since they are of size 1x1. Hence, their role is to primarily extract deppthwise information from the spatial information extracted across each channel.</p> <p>After including the imagenet weights and discarding the top layer, an architecture very similar to framework 1 was constructed on top. The layer that follows the Xception base model is a 32 filter, 5x5 convolution layer, followed by a 2x2 max-pooling layer. Two sequential 5x5 convolution layers with 64 filters are applied, followed by a 2x2 maxpooling layer. The last layer is a fully connected layer of 256 neurons followed by a 0.25 dropout. The last layer is a single neuron with a sigmoid activation function.</p> <p>The loss function for both frameworks was binary cross entropy, with an Adam optimizer with a learning rate of 0.0005. As previously mentioned, the performance metric was precision. Both frameworks were tested with 100 epochs, a patience of 20, and a batch size of 64.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/xception-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/xception-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/xception-1400.webp"></source> <img src="/assets/img/xception.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 2: Diagrammatic representation of the Xception architecture. </div> <p><strong>II. <u>Training Evaluation</u></strong></p> <p>Initially, the two frameworks presented in Table 1, were evaluated on the validation set. Table 2 shows the F1-score and BPCI at 95% confidence for the precision obtained by each framework on the validation set. We see that Framework 2 obtained a higher F1-score as well as tighter risk bounds. Hence, the remaining results will be carried out for Framework 2 only.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/table2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/table2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/table2-1400.webp"></source> <img src="/assets/img/table2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Table 2: F1-score and BPCI of the precision at 95% confidence obtained by each Framework on the validation set. </div> <p><strong>III. <u>Results</u></strong></p> <p>We evaluated the accuracy of the estimated 95% BPCI for the precision on each of the test sets, labeled A-E in later sections. Additionally, we tracked the precision, recall and F1-score for each of the test sets. We can see from Table 3, that the 95% BPCI was fairly consistent on all of the test sets. The lower bound of the 95% BPCI for precision ranged between 0.31 and 0.79, and the upper bound ranged between 4.26 and 5.57. The values for precision, recall, and the F1-score were all consistent as well.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/table3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/table3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/table3-1400.webp"></source> <img src="/assets/img/table3.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Table 3: The 95% BPCI for precision, the precision, recall and F1-score obtained by Framework 2 on each of the 5 tests sets. </div> <p><strong>IV. <u>Conclusion</u></strong></p> <p>Two CNN architectures were trained on a sample of the State Farm Distracted Driver Detection dataset to identify distracted drivers. The first framework was inspired by the shallow convolutional neural network, presented by Lei et al. The second framework utilized Xception as the base model, followed by convolution and fully connected layers. Additionally, binomial proportion confidence intervals were obtained to determine the true proportion of false positives, defined as distracted drivers falsely labeled as not distracted.</p> <p>As outlined in Table 2, framework 2 outperformed framework one in terms of F1-score and tighter binomial proportion confidence intervals were also obtained for framework 2. On 5 separate test sets, the F1-score ranged between 0.96 and 0.98, the recall ranged between 0.961 and 0.985, and the Precision ranged between 0.976 and 0.985. Additionally, the 95% BPCI for precision remained consistent amongst all of the individual test sets. The lower bound ranged between 0.31 and 0.79, and the upper bound ranged between 4.26 and 5.57.</p> <p><strong>V. <u>References</u></strong></p> <p>[1] M. Shah and S. Shanian, “Hold-out Risk Bounds for Classifier Performance Evaluation,” 2009.</p> <p>[2] N. Highway Traffic Safety Administration and U. Department of Transportation, “Distracted Driving 2020,” 2020.</p> <p>[3] A. Pal, S. Kar, and M. Bharti, “Algorithm for Distracted Driver Detection and Alert Using Deep Learning,” Optical Memory and Neural Networks (Information Optics), vol. 30, no. 3, pp. 257–265, Jul. 2021, doi: 10.3103/S1060992X21030103.</p> <p>[4] T. Abbas et al., “Deep Learning Approach Based on Residual Neural Network and SVM Classifier for Driver’s Distraction Detection,” Applied Sciences (Switzerland), vol. 12, no. 13, Jul. 2022, doi: 10.3390/app12136626.</p> <p>[5] M. Wöllmer et al., “On-line Driver Distraction Detection using Long Short-Term Memory.”</p> <p>[6] S. Masood, A. Rai, A. Aggarwal, M. N. Doja, and M. Ahmad, “Detecting distraction of drivers using Convolutional Neural Network,” Pattern Recognit Lett, vol. 139, pp. 79–85, Nov. 2020, doi: 10.1016/J.PATREC.2017.12.023.</p> <p>[7] Y. Maximov and D. Reshetova, “Tight risk bounds for multi-class margin classifiers,” Pattern Recognition and Image Analysis, vol. 26, no. 4, pp. 673–680, Oct. 2016, doi: 10.1134/S105466181604009X.</p> <p>[8] Lei, F., Liu, X., Dai, Q. Shallow convolutional neural network for image classification. SN Appl. Sci. 2, 97 (2020).</p> <p>[9] F Chollet. “Xception: Deep Learning with Depthwise Separable Convolutions”</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Andres G. Gomez. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: May 06, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>