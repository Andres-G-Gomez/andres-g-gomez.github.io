<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Chest X-RAY Segmentation | Andres G. Gomez</title> <meta name="author" content="Andres G. Gomez"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/initials.JPG?c7eece51f82ad275a2b403a984e67c06"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://andres-g-gomez.github.io/projects/7_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Andres </span>G. Gomez</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/_pages/teaching.html"></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Chest X-RAY Segmentation</h1> <p class="post-description"></p> </header> <article> <h2 id="project-objective"><u>Project Objective</u></h2> <p>Our objective was to design and train an image segmentation network to predict masks of chest X-ray images, aiding in the diagnosis and analysis of lung diseases.</p> <div class="container text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/segmentation_model-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/segmentation_model-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/segmentation_model-1400.webp"></source> <img src="/assets/img/7_project/segmentation_model.jpg" class="img-fluid d-block mx-auto w-50 w-md-75 w-lg-100" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="dataset-overview"><u>Dataset Overview</u></h2> <p>The COVID-19 Chest X-Ray dataset comprises 21,165 X-ray images categorized into four classes: COVID-19 positive (3,616), Normal (10,192), Lung Opacity (6,012), and Viral Pneumonia (1,345), along with respective masks for segmentation tasks.</p> <h2 id="image-segmentation-models"><u>Image Segmentation Models</u></h2> <p>Our selection of cutting-edge image segmentation models, including TransUNet, Swin UNet, and InternImage-T, excels in capturing fine details and structures within medical images. Leveraging advanced techniques such as transformers and hierarchical feature learning, these models deliver precise segmentation results, making them ideal candidates for our segmentation tasks.</p> <div class="container text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/transunet-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/transunet-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/transunet-1400.webp"></source> <img src="/assets/img/7_project/transunet.jpg" class="img-fluid d-block mx-auto w-50 w-md-75 w-lg-100" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>I. TransUNet</p> <ul> <li>Combines the strengths of transformers and U-Net architecture for enhanced medical image segmentation.</li> <li>Leverages self-attention mechanisms to capture long-range dependencies in the input image.</li> <li>Achieves state-of-the-art performance on multiple medical imaging benchmarks, particularly in organ and tumor segmentation tasks.</li> </ul> <div class="container text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/swinunet-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/swinunet-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/swinunet-1400.webp"></source> <img src="/assets/img/7_project/swinunet.jpg" class="img-fluid d-block mx-auto w-50 w-md-75 w-lg-100" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>II. Swin UNet</p> <ul> <li>Utilizes Swin Transformer blocks within a U-Net framework, allowing for hierarchical feature learning and improved context aggregation.</li> <li>Employs a shifting window approach to efficiently handle high-resolution images and maintain computational efficiency.</li> <li>Demonstrates superior performance in various medical image segmentation challenges, including brain tumor and lung lesion segmentation.</li> </ul> <div class="container text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/internimage-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/internimage-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/internimage-1400.webp"></source> <img src="/assets/img/7_project/internimage.jpg" class="img-fluid d-block mx-auto w-50 w-md-75 w-lg-100" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>III. InternImage-T (59M parameters)</p> <ul> <li>Integrates internal attention mechanisms with convolutional layers for refined feature extraction and segmentation precision.</li> <li>Focuses on capturing intricate patterns and textures in medical images, enhancing segmentation accuracy for complex structures.</li> <li>Proven effectiveness in segmenting diverse medical imaging modalities, such as MRI and CT scans, with notable improvements over traditional methods.</li> </ul> <h2 id="methods"><u>Methods</u></h2> <h3 id="data-augmentation-techniques">Data Augmentation Techniques</h3> <p>In this project, we conducted extensive experiments to evaluate the performance of various image segmentation models on the COVID-19 Chest X-Ray dataset. We tested different data augmentation techniques to improve model generalization and robustness. The experiments were designed to compare the performance with and without data augmentation, specifically focusing on:</p> <ul> <li>i. No data augmentation</li> <li>ii. Data augmentation - Zoom in and center crop + left-right flip.</li> </ul> <h3 id="training-setup">Training Setup</h3> <ul> <li> <strong>Batch Size</strong>: 32</li> <li> <strong>Criterion</strong>: Binary Cross Entropy (BCE) loss</li> <li> <strong>Optimizer</strong>: Adam with lr=1e-4</li> <li> <strong>Learning Rate Scheduler</strong>: ReduceLROnPlateau with patience of 25 epochs</li> <li> <strong>Training Duration</strong>: Up to 500 epochs or until validation loss increases continuously.</li> </ul> <h2 id="results"><u>Results</u></h2> <p>The test set results show that both the TransUNet and Swin UNet models achieved high mean dice scores, with values of approximately 0.951 and 0.954, respectively, when augmentation was applied. Without augmentation, the dice scores remained high, with values around 0.963 for TransUNet and 0.960 for Swin UNet. Additionally, the mean Hausdorff distance (HD95) values were relatively low, ranging from approximately 2.076 to 4.091 millimeters across different models and augmentation scenarios, indicating accurate segmentation performance. Notably, the InternImage model demonstrated exceptionally high dice scores of 0.9801 and 0.9824 for 6k and 60k iterations, respectively, showcasing superior segmentation accuracy compared to the other models.</p> <p><strong>Test Results:</strong></p> <table> <thead> <tr> <th>Models</th> <th>Mean dice (With Augmentation)</th> <th>Mean dice (W/o Augmentation)</th> <th>Mean hd95 (mm) (With Augmentation)</th> <th>Mean hd95 (mm) (W/o Augmentation)</th> </tr> </thead> <tbody> <tr> <td>TrransUNet</td> <td>0.9509</td> <td>0.9629</td> <td>3.012</td> <td>2.828</td> </tr> <tr> <td>Swin Unet</td> <td>0.9544</td> <td>0.9600</td> <td>4.091</td> <td>3.338</td> </tr> <tr> <td>InternImage (6k iterations)</td> <td>N/A</td> <td>0.9801</td> <td>N/A</td> <td>2.283</td> </tr> <tr> <td>InternImage (60k iterations)</td> <td>N/A</td> <td>0.9824</td> <td>N/A</td> <td>2.076</td> </tr> </tbody> </table> <p>Below, we showcase qualitative results obtained from the InternImage-T and SwinUNet models.</p> <div class="row"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/swinunetResults-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/swinunetResults-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/swinunetResults-1400.webp"></source> <img src="/assets/img/7_project/swinunetResults.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example Image 1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/swinunetResults2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/swinunetResults2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/swinunetResults2-1400.webp"></source> <img src="/assets/img/7_project/swinunetResults2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example Image 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Segmentation results for SwinUNet are displayed. On the left, input images, original masks, and predicted segmentation results from both data augmentation and no augmentation experiments are shown. On the right, the predicted mask is overlaid on the input image for visualization. </div> <div class="row"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/6kInternimage-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/6kInternimage-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/6kInternimage-1400.webp"></source> <img src="/assets/img/7_project/6kInternimage.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example Image 1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/7_project/60kInternimage-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/7_project/60kInternimage-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/7_project/60kInternimage-1400.webp"></source> <img src="/assets/img/7_project/60kInternimage.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example Image 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Segmentation results for InternImage-T models are showcased. Each image displays, from left to right, the ground truth, the predicted mask, and the non-overlapping image. The left and right images correspond to the 6k and 60k iteration InternImage-T models, respectively. </div> <h2 id="conclusion"><u>Conclusion</u></h2> <p>The project successfully developed and evaluated image segmentation models for chest X-ray images, showcasing competitive performance and highlighting the effectiveness of transformer-based architectures in medical image analysis. Further research could explore ensemble methods and domain-specific pretraining to enhance segmentation accuracy further.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Andres G. Gomez. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 23, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>